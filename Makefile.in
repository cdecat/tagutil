PROG		= @PACKAGE@

CC		?= @CC@
RM		= @RM@ -f
GZIP		= @GZIP@

CFLAGS		@CFLAGSMOD@ @CFLAGS@ @BSD_SOURCE_CFLAGS@ @DEBUG_CFLAGS@
LDFLAGS		= @LIBS@
SRCS		= tagutil.c t_toolkit.c t_lexer.c t_parser.c t_interpreter.c t_compat.c
OBJS		= tagutil.o t_toolkit.o t_lexer.o t_parser.o t_interpreter.o t_compat.o

MAN1		= ${PROG}.1
MAN		= ${MAN1}.gz
PREFIX		?= @PREFIX@
BINDIR		?= @BINDIR@
MANDIR		?= @MANDIR@
MAN1DIR		?= @MAN1DIR@

INSTALL		?= @INSTALL@
INSTALL_BIN	= ${INSTALL} -m 755
INSTALL_MAN	= ${INSTALL} -m 644


all: depends ${PROG} ${MAN}

${PROG}: ${OBJS}
	${CC} -o ${PROG} ${LDFLAGS} ${OBJS}

${MAN}: ${MAN1}
	${GZIP} -cn ${MAN1} > ${MAN}

depends:
	@${CC} ${CFLAGS} -E -MM ${SRCS} > .depend

clean:
	-${RM} ${OBJS} ${PROG} ${MAN}

install:
	${INSTALL_BIN} ${PROG} ${PREFIX}/${BINDIR}
	${INSTALL_MAN} ${MAN}  ${PREFIX}/${MAN1DIR}

uninstall:
	${RM} ${PREFIX}/${BINDIR}/${PROG}
	${RM} ${PREFIX}/${MAN1DIR}/${MAN}
